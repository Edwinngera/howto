sudo apt-get install nethogs  # ubuntu 15.04
sudo nethogs wlan0
sudo nethogs eth0


sudo apt-get install speedometer # ubuntu 15.04
sudo speedometer -r eth0 -t eth0
sudo speedometer -r wlan0 -t wlan0
sudo speedometer -l  -r wlan0 -t wlan0 -m $(( 1024 * 1024 * 3 / 2 ))


sudo apt-get install iptraf
sudo apt-get install iptraf iptraf-ng
sudo iptraf


sudo apt-get install iftop
sudo iftop -n


sudo apt-get install ifstat
sudo ifstat
sudo ifstat -t -i eth0 0.5


sudo apt-get install netdiag
sudo netload eth0


tcpdump -i eth0
ifconfig
sudo netwatch -e eth0 -nt
sudo trafshow -i eth0 tcp

http://www.binarytides.com/linux-commands-monitor-network/


#####################################
#
# tcpdump and iptables management
#
#####################################
-------------------------------------
#sudo apt-get install tcpflow
#tcpflow -p -c -i eth0 port 80

sudo -i
tcpdump -vvv -s 0 -l -n port 53  # print DNS outgoing queries
sudo tcpdump -i any -w /tmp/http.log &
killall tcpdump
tcpdump -A -r /tmp/http.log | less

helpful flags (options):
-i Specify an interface
-i eth0
tcp port xx
tcp port 80
dst 1.2.3.4
specify a destination ip address

sudo service apport start
sudo service apport stop

sudo tcpdump -i br0 -n | egrep "91.189.95.54|91.189.95.55"

# Ubuntu keeps sending DNS queries to daisy
sudo -s
initctl stop network-manager
echo 'manual' > /etc/init/network-manager.override
sudo dpkg --remove whoopsie

-------------------------------------

sudo apt-get install wireshark
sudo wireshark
https://apps.ubuntu.com/cat/applications/wireshark/

------------------------------------

# Useful to detect DNS amplification
tcpdump -nnni bond0 -c 100 -w sample.txt dst port 53

# which bogus DNS resolvers are sending you an amplified attack.
awk '{print $3}' sample.txt | cut -d '.' -f1-4 | sort | uniq -c | sort -nr

# Network management
sh int Te0/1 | i rate

(INPUT/OUTPUT/FORWARD)
iptables -A INPUT -p tcp -d 192.168.0.12 -m tcp ! --dport 53 -j DROP
iptables -A INPUT -p udp -d 192.168.0.12 -m udp ! --dport 53 -j DROP
iptables -A INPUT -m tcp -p tcp --dport 53 -j ACCEPT

# Block All UDP Ports Through iptable Accept DNS
iptables -A INPUT -p udp --sport 53 -j ACCEPT
iptables -A INPUT -p udp --dport 53 -j ACCEPT
iptables -A OUTPUT -p udp --sport 53 -j ACCEPT
iptables -A OUTPUT -p udp --dport 53 -j ACCEPT

iptables -A INPUT -p udp -j DROP
iptables -A OUTPUT -p udp -j DROP

netstat -tanpl | grep named
netstat -tupln

nmap -T4 -A -v stackoverflow.com
nmap -T4 -A -v --dns-servers 8.8.8.8 scanme.nmap.org

scan the IP address of your VPS for all UDP and TCP ports:
nmap -sU -sS -p1-65535 <vps ip>
tcpdump -i <interface name> host <public IP address of wifi router>
13:23:32.805549 IP <wifi router>.2154 > <vps>.ssh

